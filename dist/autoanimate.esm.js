var $=new Set,a=new WeakMap,w=new WeakMap,l=new WeakMap,W=new WeakMap,_=new WeakMap,b=new WeakMap,M=new WeakMap,h,g="__aa_tgt",C="__aa_del",k=t=>{let e=R(t);e&&e.forEach(n=>q(n))},j=t=>{t.forEach(e=>{e.target===h&&F(),a.has(e.target)&&m(e.target)})};function B(t){let e=W.get(t);e?.disconnect();let n=a.get(t),o=0,i=5;n||(n=y(t),a.set(t,n));let{offsetWidth:d,offsetHeight:c}=h,p=[n.top-i,d-(n.left+i+n.width),c-(n.top+i+n.height),n.left-i].map(f=>`${-1*Math.floor(f)}px`).join(" "),r=new IntersectionObserver(()=>{++o>1&&m(t)},{root:h,threshold:1,rootMargin:p});r.observe(t),W.set(t,r)}function m(t){clearTimeout(M.get(t));let e=x(t),n=typeof e=="function"?500:e.duration;M.set(t,setTimeout(()=>{let o=l.get(t);(!o||o.finished)&&(a.set(t,y(t)),B(t))},n))}function F(){clearTimeout(M.get(h)),M.set(h,setTimeout(()=>{$.forEach(t=>L(t,e=>A(()=>m(e))))},100))}function I(t){setTimeout(()=>{_.set(t,setInterval(()=>A(m.bind(null,t)),2e3))},Math.round(2e3*Math.random()))}function A(t){typeof requestIdleCallback=="function"?requestIdleCallback(()=>t()):requestAnimationFrame(()=>t())}var P,v;typeof window<"u"&&(h=document.documentElement,P=new MutationObserver(k),v=new ResizeObserver(j),v.observe(h));function R(t){return t.reduce((e,n)=>{if(e===!1)return!1;if(n.target instanceof Element){if(T(n.target),!e.has(n.target)){e.add(n.target);for(let o=0;o<n.target.children.length;o++){let i=n.target.children.item(o);if(!!i){if(C in i)return!1;T(n.target,i),e.add(i)}}}if(n.removedNodes.length)for(let o=0;o<n.removedNodes.length;o++){let i=n.removedNodes[o];if(C in i)return!1;i instanceof Element&&(e.add(i),T(n.target,i),w.set(i,[n.previousSibling,n.nextSibling]))}}return e},new Set)}function T(t,e){!e&&!(g in t)?Object.defineProperty(t,g,{value:t}):e&&!(g in e)&&Object.defineProperty(e,g,{value:t})}function q(t){var e;let n=h.contains(t),o=a.has(t);n&&w.has(t)&&w.delete(t),l.has(t)&&((e=l.get(t))===null||e===void 0||e.cancel()),o&&n?X(t):o&&!n?H(t):Y(t)}function u(t){return Number(t.replace(/[^0-9.\-]/g,""))}function y(t){let e=t.getBoundingClientRect();return{top:e.top+window.scrollY,left:e.left+window.scrollX,width:e.width,height:e.height}}function S(t,e,n){let o=e.width,i=e.height,d=n.width,c=n.height,s=getComputedStyle(t);if(s.getPropertyValue("box-sizing")==="content-box"){let r=u(s.paddingTop)+u(s.paddingBottom)+u(s.borderTopWidth)+u(s.borderBottomWidth),f=u(s.paddingLeft)+u(s.paddingRight)+u(s.borderRightWidth)+u(s.borderLeftWidth);o-=f,d-=f,i-=r,c-=r}return[o,d,i,c].map(Math.round)}function x(t){return g in t&&b.has(t[g])?b.get(t[g]):{duration:250,easing:"ease-in-out"}}function L(t,...e){e.forEach(n=>n(t,b.has(t)));for(let n=0;n<t.children.length;n++){let o=t.children.item(n);o&&e.forEach(i=>i(o,b.has(o)))}}function X(t){let e=a.get(t),n=y(t),o;if(!e)return;let i=x(t);if(typeof i!="function"){let d=e.left-n.left,c=e.top-n.top,[s,p,r,f]=S(t,e,n),E={transform:`translate(${d}px, ${c}px)`},O={transform:"translate(0, 0)"};s!==p&&(E.width=`${s}px`,O.width=`${p}px`),r!==f&&(E.height=`${r}px`,O.height=`${f}px`),o=t.animate([E,O],i)}else o=new Animation(i(t,"remain",e,n)),o.play();l.set(t,o),a.set(t,n),o.addEventListener("finish",m.bind(null,t))}function Y(t){let e=y(t);a.set(t,e);let n=x(t),o;typeof n!="function"?o=t.animate([{transform:"scale(.98)",opacity:0},{transform:"scale(0.98)",opacity:0,offset:.5},{transform:"scale(1)",opacity:1}],{duration:n.duration*1.5,easing:"ease-in"}):(o=new Animation(n(t,"add",e)),o.play()),l.set(t,o),o.addEventListener("finish",m.bind(null,t))}function H(t){if(!w.has(t)||!a.has(t))return;let[e,n]=w.get(t);Object.defineProperty(t,C,{value:!0}),n&&n.parentNode&&n.parentNode instanceof Element?n.parentNode.insertBefore(t,n):e&&e.parentNode&&e.parentNode.appendChild(t);let[o,i,d,c]=Q(t),s=x(t),p=a.get(t),r;Object.assign(t.style,{position:"absolute",top:`${o}px`,left:`${i}px`,width:`${d}px`,height:`${c}px`,margin:0,pointerEvents:"none",transformOrigin:"center",zIndex:100}),typeof s!="function"?r=t.animate([{transform:"scale(1)",opacity:1},{transform:"scale(.98)",opacity:0}],{duration:s.duration,easing:"ease-out"}):(r=new Animation(s(t,"remove",p)),r.play()),l.set(t,r),r.addEventListener("finish",()=>{var f;t.remove(),a.delete(t),w.delete(t),l.delete(t),(f=W.get(t))===null||f===void 0||f.disconnect()})}function Q(t){let e=a.get(t),[n,,o]=S(t,e,y(t)),i=t.parentElement;for(;i&&(getComputedStyle(i).position==="static"||i instanceof HTMLBodyElement);)i=i.parentElement;i||(i=document.body);let d=getComputedStyle(i),c=a.get(i)||y(i),s=Math.round(e.top-c.top)-u(d.borderTopWidth),p=Math.round(e.left-c.left)-u(d.borderLeftWidth);return[s,p,n,o]}function N(t,e={}){if(P&&v){if(window.matchMedia("(prefers-reduced-motion: reduce)").matches)return;getComputedStyle(t).position==="static"&&Object.assign(t.style,{position:"relative"}),L(t,m,I,o=>v?.observe(o)),typeof e=="function"?b.set(t,e):b.set(t,{duration:250,easing:"ease-in-out",...e}),P.observe(t,{childList:!0}),$.add(t)}}function z(t){t.directive("autoanimate",(e,{expression:n},{evaluate:o})=>{N(e,o(n)||{})})}var K=z;export{K as default};
